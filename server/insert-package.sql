SET VERIFY OFF;
SET SERVEROUTPUT ON;


CREATE OR REPLACE PACKAGE INSERT_PACK AS

	PROCEDURE DATA_INSERT(
	PID DATASET.ID%TYPE,
	POUTLOOK DATASET.OUTLOOK%TYPE,
	PTEMPERATURE DATASET.TEMPERATURE%TYPE,
	PHUMIDITY DATASET.HUMIDITY%TYPE,
	PRAIN DATASET.RAIN%TYPE
);


END INSERT_PACK;
/


CREATE OR REPLACE PACKAGE BODY INSERT_PACK AS 
	PROCEDURE DATA_INSERT
	(
		PID DATASET.ID%TYPE,
		POUTLOOK DATASET.OUTLOOK%TYPE,
		PTEMPERATURE DATASET.TEMPERATURE%TYPE,
		PHUMIDITY DATASET.HUMIDITY%TYPE,
		PRAIN DATASET.RAIN%TYPE
	)
	IS

	BEGIN
		 INSERT INTO DATASET (ID, OUTLOOK, TEMPERATURE, HUMIDITY, RAIN) VALUES (PID, POUTLOOK, PTEMPERATURE, PHUMIDITY, PRAIN);
		 COMMIT;

	END DATA_INSERT;
END INSERT_PACK;
/

DECLARE
	TID DATASET.ID%TYPE;
	TOUTLOOK DATASET.OUTLOOK%TYPE;
	TTEMPERATURE DATASET.TEMPERATURE%TYPE;
	THUMIDITY DATASET.HUMIDITY%TYPE;
	TRAIN DATASET.RAIN%TYPE;

	NEGATIVE_VALUE EXCEPTION;
	INVALID_OUTLOOK EXCEPTION;
	INVALID_TEMPERATURE EXCEPTION;
	INVALID_HUMIDITY EXCEPTION;
	INVALID_RAIN EXCEPTION;

BEGIN


	
	TID := &ID;
	TOUTLOOK := '&OUTLOOK';
	TTEMPERATURE := '&TEMPERATURE';
	THUMIDITY := '&HUMIDITY';
	TRAIN := '&RAIN';





	IF TID<0 THEN
		RAISE NEGATIVE_VALUE;
	END IF;

	IF NOT (TOUTLOOK ='sunny' or TOUTLOOK = 'windy' or TOUTLOOK = 'overcast') THEN
		RAISE INVALID_OUTLOOK;
	END IF;

	IF NOT (TTEMPERATURE ='hot' or TTEMPERATURE = 'mild' or TTEMPERATURE = 'cool') THEN
		RAISE INVALID_TEMPERATURE;
	END IF;

	IF NOT (THUMIDITY<>'high' or THUMIDITY <> 'normal') THEN
		RAISE INVALID_HUMIDITY;
	END IF;

	IF NOT (TRAIN = 'yes' or TRAIN = 'no') THEN
		RAISE INVALID_RAIN;
	END IF;

	INSERT_PACK.DATA_INSERT(TID, TOUTLOOK, TTEMPERATURE, THUMIDITY, TRAIN);


	COMMIT;

	EXCEPTION
		WHEN NEGATIVE_VALUE THEN
			DBMS_OUTPUT.PUT_LINE('ID CANNOT BE NEGATIVE VALUE');
		WHEN INVALID_OUTLOOK THEN
			DBMS_OUTPUT.PUT_LINE('Enter either sunny or windy or overcast in outlook');
		WHEN INVALID_TEMPERATURE THEN
			DBMS_OUTPUT.PUT_LINE('Enter either hot or mild or cool in temperature');
		WHEN INVALID_HUMIDITY THEN
			DBMS_OUTPUT.PUT_LINE('Enter either high or noraml in humidity');
		WHEN INVALID_RAIN THEN
			DBMS_OUTPUT.PUT_LINE('Enter either yes or no in rain');

END;
/
